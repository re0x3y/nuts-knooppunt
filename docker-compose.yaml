services:
  knooppunt:
    build: .
    ports:
      - "8080:8080"
      - "8081:8081"
    environment:
      KNPT_TRACING_OTLPENDPOINT: ${KNPT_TRACING_OTLPENDPOINT:-aspire-dashboard:18890}
    volumes:
      - ./config:/app/config:ro

  # Aspire Dashboard - unified observability for traces, logs, and metrics
  # UI available at http://localhost:18888
  aspire-dashboard:
    image: mcr.microsoft.com/dotnet/aspire-dashboard:latest
    container_name: aspire-dashboard
    ports:
      - "18888:18888"  # Dashboard UI
      - "4317:18889"   # OTLP gRPC endpoint
      - "4318:18890"   # OTLP HTTP endpoint
    environment:
      DOTNET_DASHBOARD_UNSECURED_ALLOW_ANONYMOUS: "true"
